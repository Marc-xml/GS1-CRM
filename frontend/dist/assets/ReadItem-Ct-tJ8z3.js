import{aq as P,ap as k,ai as L,a as c,ah as t}from"./index-Cd0kSdaF.js";import{P as B}from"./index-D1k_-FKY.js";import{E as F,B as x,W as O,V as W,Z as j,Y as g,X as r}from"./IdurarOs-Vv71th3u.js";import{e as S}from"./actions-BiJ_6wdU.js";import{s as m}from"./index-KrFx5yLV.js";import{c as q}from"./selectors-CaHUuIKE.js";import{u as A}from"./useDate-BcaeHTEz.js";import{u as M,S as p}from"./useMail-DJ4qEEWM.js";import{t as b}from"./statusTagColor-DxbKI3gy.js";import{T as v}from"./index-DZGkyCsu.js";import{R as Y}from"./RetweetOutlined-BcHIyFHS.js";import{D as h}from"./index-BSUnYqS5.js";import{C as H}from"./CloseCircleOutlined-BhBCd0r7.js";import{F as Q}from"./FilePdfOutlined-DEQ3xdwW.js";const U=({item:a,currentErp:l})=>{const{moneyFormatter:s}=A();return t.jsxs(j,{gutter:[12,0],children:[t.jsxs(r,{className:"gutter-row",span:11,children:[t.jsx("p",{style:{marginBottom:5},children:t.jsx("strong",{children:a.itemName})}),t.jsx("p",{children:a.description})]}),t.jsx(r,{className:"gutter-row",span:4,children:t.jsx("p",{style:{textAlign:"right"},children:s({amount:a.price,currency_code:l.currency})})}),t.jsx(r,{className:"gutter-row",span:4,children:t.jsx("p",{style:{textAlign:"right"},children:a.quantity})}),t.jsx(r,{className:"gutter-row",span:5,children:t.jsx("p",{style:{textAlign:"right",fontWeight:"700"},children:s({amount:a.total,currency_code:l.currency})})}),t.jsx(g,{dashed:!0,style:{marginTop:0,marginBottom:15}})]},a._id)};function ot({config:a,selectedItem:l}){var _,$;const s=F(),{entity:n,ENTITY_NAME:E}=a,C=P(),y=k(),{moneyFormatter:i}=A();M({entity:n});const{result:d}=L(q),T={status:"",client:{name:"",email:"",phone:"",address:""},subTotal:0,taxTotal:0,taxRate:0,total:0,credit:0,number:0,year:0},[R,f]=c.useState([]),[e,w]=c.useState(l??T),[N,I]=c.useState({});return c.useEffect(()=>{if(d){const{items:o,invoice:u,...D}=d;o?(f(o),w(d)):u.items&&(f(u.items),w({...u.items,...D,...u}))}return()=>{f([]),w(T)}},[d]),c.useEffect(()=>{e!=null&&e.client&&I(e.client[e.client.type])},[e]),t.jsxs(t.Fragment,{children:[t.jsx(B,{onBack:()=>{y(`/${n.toLowerCase()}`)},title:`${E} # ${e.number}/${e.year||""}`,ghost:!1,tags:[t.jsx(v,{color:(_=b(e.status))==null?void 0:_.color,children:e.status&&s(e.status)},"status"),e.paymentStatus&&t.jsx(v,{color:($=b(e.paymentStatus))==null?void 0:$.color,children:e.paymentStatus&&s(e.paymentStatus)},"paymentStatus")],extra:[t.jsx(x,{onClick:()=>{y(`/${n.toLowerCase()}`)},icon:t.jsx(H,{}),children:s("Close")},`${m.generate()}`),t.jsx(x,{onClick:()=>{window.open(`${O}${n}/${n}-${e._id}.pdf`,"_blank")},icon:t.jsx(Q,{}),children:s("Download PDF")},`${m.generate()}`),t.jsx(x,{onClick:()=>{C(S.convert({entity:n,id:e._id}))},icon:t.jsx(Y,{}),style:{display:n==="quote"?"inline-block":"none"},children:s("Convert to Invoice")},`${m.generate()}`),t.jsx(x,{onClick:()=>{C(S.currentAction({actionType:"update",data:e})),y(`/${n.toLowerCase()}/update/${e._id}`)},type:"primary",icon:t.jsx(W,{}),children:s("Edit")},`${m.generate()}`)],style:{padding:"20px 0px"},children:t.jsxs(j,{children:[t.jsx(p,{title:"Status",value:e.status}),t.jsx(p,{title:s("SubTotal"),value:i({amount:e.subTotal,currency_code:e.currency}),style:{margin:"0 32px"}}),t.jsx(p,{title:s("Total"),value:i({amount:e.total,currency_code:e.currency}),style:{margin:"0 32px"}}),t.jsx(p,{title:s("Paid"),value:i({amount:e.credit,currency_code:e.currency}),style:{margin:"0 32px"}})]})}),t.jsx(g,{dashed:!0}),t.jsxs(h,{title:`Client : ${e.client.name}`,children:[t.jsx(h.Item,{label:s("Address"),children:N.address}),t.jsx(h.Item,{label:s("email"),children:N.email}),t.jsx(h.Item,{label:s("Phone"),children:N.phone})]}),t.jsx(g,{}),t.jsxs(j,{gutter:[12,0],children:[t.jsx(r,{className:"gutter-row",span:11,children:t.jsx("p",{children:t.jsx("strong",{children:s("Product")})})}),t.jsx(r,{className:"gutter-row",span:4,children:t.jsx("p",{style:{textAlign:"right"},children:t.jsx("strong",{children:s("Price")})})}),t.jsx(r,{className:"gutter-row",span:4,children:t.jsx("p",{style:{textAlign:"right"},children:t.jsx("strong",{children:s("Quantity")})})}),t.jsx(r,{className:"gutter-row",span:5,children:t.jsx("p",{style:{textAlign:"right"},children:t.jsx("strong",{children:s("Total")})})}),t.jsx(g,{})]}),R.map(o=>t.jsx(U,{item:o,currentErp:e},o._id)),t.jsx("div",{style:{width:"300px",float:"right",textAlign:"right",fontWeight:"700"},children:t.jsxs(j,{gutter:[12,-5],children:[t.jsx(r,{className:"gutter-row",span:12,children:t.jsxs("p",{children:[s("Sub Total")," :"]})}),t.jsx(r,{className:"gutter-row",span:12,children:t.jsx("p",{children:i({amount:e.subTotal,currency_code:e.currency})})}),t.jsx(r,{className:"gutter-row",span:12,children:t.jsxs("p",{children:[s("Tax Total")," (",e.taxRate," %) :"]})}),t.jsx(r,{className:"gutter-row",span:12,children:t.jsx("p",{children:i({amount:e.taxTotal,currency_code:e.currency})})}),t.jsx(r,{className:"gutter-row",span:12,children:t.jsxs("p",{children:[s("Total")," :"]})}),t.jsx(r,{className:"gutter-row",span:12,children:t.jsx("p",{children:i({amount:e.total,currency_code:e.currency})})})]})})]})}export{ot as R};
