import{a as s,ap as W,ah as r}from"./index-Cd0kSdaF.js";import{E as $,_ as z,M as B}from"./IdurarOs-Vv71th3u.js";import{u as F}from"./useDebounce-goFyg7-P.js";import{S as l,E as G}from"./index-DHqFXhNz.js";function P({entity:x,displayLabels:E,searchFields:b,outputValue:a="_id",redirectLabel:O="Add New",withRedirect:u=!1,urlToRedirect:j="/",value:t,onChange:c}){const f=$(),h={value:"redirectURL",label:`+ ${f(O)}`},[y,d]=s.useState([]),[A,C]=s.useState(void 0),n=s.useRef(!0),v=s.useRef(!1),[L,o]=s.useState(!1),[S,R]=s.useState(""),[p,N]=s.useState(""),U=W(),q=e=>{n.current=!1,c&&e&&c(e[a]||e),e==="redirectURL"&&u&&U(j)},[,D]=F(()=>{N(S)},500,[S]),T=async e=>await B.search({entity:x,options:e});let{onFetch:_,result:m,isSuccess:g,isLoading:k}=z();const w=e=>E.map(i=>e[i]).join(" ");s.useEffect(()=>{const i=T({q:p,fields:b});return _(i),()=>{D()}},[p]);const M=e=>{v.current=!0,o(!0),R(e)};return s.useEffect(()=>{g?d(m):o(!1)},[g,m]),s.useEffect(()=>{t&&n.current&&(d([t]),C(t[a]||t),c(t[a]||t),n.current=!1)},[t]),r.jsxs(l,{loading:k,showSearch:!0,allowClear:!0,placeholder:f("Search"),defaultActiveFirstOption:!1,filterOption:!1,notFoundContent:L?"... Searching":r.jsx(G,{}),value:A,onSearch:M,onClear:()=>{o(!1)},onChange:q,style:{minWidth:"220px"},children:[y.map(e=>r.jsx(l.Option,{value:e[a]||e,children:w(e)},e[a]||e)),u&&r.jsx(l.Option,{value:h.value,children:h.label})]})}export{P as A};
