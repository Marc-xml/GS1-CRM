import{aq as B,ap as I,ai as N,a as u,ar as O,ah as a}from"./index-Cd0kSdaF.js";import{d,P as Z}from"./index-D1k_-FKY.js";import{E as A,a0 as T,B as $,Y as z,a2 as G}from"./IdurarOs-Vv71th3u.js";import{e as b}from"./actions-BiJ_6wdU.js";import{c as Y}from"./calculate-BDnin_T9.js";import{s as E}from"./index-KrFx5yLV.js";import{d as J}from"./selectors-CaHUuIKE.js";import{t as F}from"./statusTagColor-DxbKI3gy.js";import{T as L}from"./index-DZGkyCsu.js";import{C as K}from"./CloseCircleOutlined-BhBCd0r7.js";import{P as Q}from"./PlusOutlined-Eme4bCvn.js";function W({form:l,translate:x}){const s=()=>{l.submit()};return a.jsx($,{onClick:s,type:"primary",icon:a.jsx(Q,{}),children:x("update")})}function ct({config:l,UpdateForm:x}){var C,D;const s=A();let{entity:m}=l;const y=B(),f=I(),{current:n,isLoading:q,isSuccess:S}=N(J),[c]=T.useForm(),[v,h]=u.useState(0),H={status:"",client:{name:"",email:"",phone:"",address:""},subTotal:0,taxTotal:0,taxRate:0,total:0,credit:0,number:0,year:0},[o,P]=u.useState(n??H),{id:j}=O(),k=(t,e)=>{const p=e.items;let r=0;p&&(p.map(i=>{if(i&&i.quantity&&i.price){let g=Y.multiply(i.quantity,i.price);r=Y.add(r,g)}}),h(r))},w=t=>{let e={...t};if(t&&((t.date||t.expiredDate)&&(e.date=d(t.date).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),e.expiredDate=d(t.expiredDate).format("YYYY-MM-DDTHH:mm:ss.SSSZ")),t.items)){let p=[];t.items.map(r=>{const{quantity:i,price:g,itemName:M,description:R}=r,U=r.quantity*r.price;p.push({total:U,quantity:i,price:g,itemName:M,description:R})}),e.items=p}y(b.update({entity:m,id:j,jsonData:e}))};return u.useEffect(()=>{S&&(c.resetFields(),h(0),y(b.resetAction({actionType:"update"})),f(`/${m.toLowerCase()}/read/${j}`))},[S]),u.useEffect(()=>{if(n){P(n);let t={...n};t.date&&(t.date=d(t.date)),t.expiredDate&&(t.expiredDate=d(t.expiredDate)),t.taxRate||(t.taxRate=0);const{subTotal:e}=t;c.resetFields(),c.setFieldsValue(t),h(e)}},[n]),a.jsxs(a.Fragment,{children:[a.jsx(Z,{onBack:()=>{f(`/${m.toLowerCase()}`)},title:s("update"),ghost:!1,tags:[a.jsx(L,{color:(C=F(o.status))==null?void 0:C.color,children:o.status&&s(o.status)},"status"),o.paymentStatus&&a.jsx(L,{color:(D=F(o.paymentStatus))==null?void 0:D.color,children:o.paymentStatus&&s(o.paymentStatus)},"paymentStatus")],extra:[a.jsx($,{onClick:()=>{f(`/${m.toLowerCase()}`)},icon:a.jsx(K,{}),children:s("Cancel")},`${E.generate()}`),a.jsx(W,{translate:s,form:c},`${E.generate()}`)],style:{padding:"20px 0px"}}),a.jsx(z,{dashed:!0}),a.jsx(G,{isLoading:q,children:a.jsx(T,{form:c,layout:"vertical",onFinish:w,onValuesChange:k,children:a.jsx(x,{subTotal:v,current:n})})})]})}export{ct as U};
