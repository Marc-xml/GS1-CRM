import{aq as I,ap as $,a as l,ai as b,ah as e,ar as k,aw as B}from"./index-Cd0kSdaF.js";import{E as R,B as m,W as F,V as M,Z as g,Y as f,X as a,$ as W}from"./IdurarOs-Vv71th3u.js";import"./index-CPNcZCnD.js";import{c as Y,s as q,E as C}from"./selectors-CaHUuIKE.js";import{P as U}from"./index-D1k_-FKY.js";import{e as N}from"./actions-BiJ_6wdU.js";import{s as p}from"./index-KrFx5yLV.js";import{u as v}from"./useDate-BcaeHTEz.js";import{u as H,S as h}from"./useMail-DJ4qEEWM.js";import{t as Q}from"./statusTagColor-DxbKI3gy.js";import{T as V}from"./index-DZGkyCsu.js";import{D as j}from"./index-BSUnYqS5.js";import{C as X}from"./CloseCircleOutlined-BhBCd0r7.js";import{F as Z}from"./FilePdfOutlined-DEQ3xdwW.js";import{R as z}from"./RetweetOutlined-BcHIyFHS.js";import"./ErpApp-DLeU0-DG.js";import"./DownOutlined-BTlj5zpM.js";const G=({item:r,currentErp:o})=>{const{moneyFormatter:s}=v();return e.jsxs(g,{gutter:[12,0],children:[e.jsxs(a,{className:"gutter-row",span:11,children:[e.jsx("p",{style:{marginBottom:5},children:e.jsx("strong",{children:r.itemName})}),e.jsx("p",{children:r.description})]}),e.jsx(a,{className:"gutter-row",span:4,children:e.jsx("p",{style:{textAlign:"right"},children:s({amount:r.price,currency_code:o.currency})})}),e.jsx(a,{className:"gutter-row",span:4,children:e.jsx("p",{style:{textAlign:"right"},children:r.quantity})}),e.jsx(a,{className:"gutter-row",span:5,children:e.jsx("p",{style:{textAlign:"right",fontWeight:"700"},children:s({amount:r.total,currency_code:o.currency})})}),e.jsx(f,{dashed:!0,style:{marginTop:0,marginBottom:15}})]},r._id)};function J({config:r,selectedItem:o}){var A;const s=R(),{entity:n,ENTITY_NAME:y}=r,c=I(),{moneyFormatter:i}=v();H({entity:n});const T=$(),[w,O]=l.useState({}),{result:d}=b(Y),D={status:"",lead:{name:"",email:"",phone:"",address:""},subTotal:0,taxTotal:0,taxRate:0,total:0,credit:0,number:0,year:0},[P,_]=l.useState([]),[t,E]=l.useState(o??D);return l.useEffect(()=>{const u=new AbortController;if(d){const{items:L,invoice:x,...S}=d;L?(_(L),E(d)):x.items&&(_(x.items),E({...x.items,...S,...x}))}return()=>u.abort()},[d]),l.useEffect(()=>{t!=null&&t.lead&&O(t.lead[t.lead.type])},[t]),e.jsxs(e.Fragment,{children:[e.jsx(U,{onBack:()=>{T(`/${n.toLowerCase()}`)},title:`${y} # ${t.number}/${t.year||""}`,ghost:!1,tags:e.jsx(V,{color:(A=Q(t.status))==null?void 0:A.color,children:s(t.status)}),extra:[e.jsx(m,{onClick:()=>{T(`/${n.toLowerCase()}`)},icon:e.jsx(X,{}),children:s("Close")},`${p.generate()}`),e.jsx(m,{onClick:()=>{window.open(`${F}${n}/${n}-${t._id}.pdf`,"_blank")},icon:e.jsx(Z,{}),children:s("Download PDF")},`${p.generate()}`),e.jsx(m,{onClick:()=>{c(N.convert({entity:n,id:t._id}))},icon:e.jsx(z,{}),style:{display:n==="quote"?"inline-block":"none"},children:s("Convert to Invoice")},`${p.generate()}`),e.jsx(m,{onClick:()=>{c(N.currentAction({actionType:"update",data:t})),T(`/${n.toLowerCase()}/update/${t._id}`)},type:"primary",icon:e.jsx(M,{}),children:s("Edit")},`${p.generate()}`)],style:{padding:"20px 0px"},children:e.jsxs(g,{children:[e.jsx(h,{title:"Status",value:t.status}),e.jsx(h,{title:s("SubTotal"),value:i({amount:t.subTotal,currency_code:t.currency}),style:{margin:"0 32px"}}),e.jsx(h,{title:s("Total"),value:i({amount:t.total,currency_code:t.currency}),style:{margin:"0 32px"}}),e.jsx(h,{title:s("Paid"),value:i({amount:t.credit,currency_code:t.currency}),style:{margin:"0 32px"}})]})}),e.jsx(f,{dashed:!0}),e.jsxs(j,{title:`lead : ${t.lead.name}`,children:[e.jsx(j.Item,{label:s("Address"),children:w.address}),e.jsx(j.Item,{label:s("email"),children:w.email}),e.jsx(j.Item,{label:s("Phone"),children:w.phone})]}),e.jsx(f,{}),e.jsxs(g,{gutter:[12,0],children:[e.jsx(a,{className:"gutter-row",span:11,children:e.jsx("p",{children:e.jsx("strong",{children:s("product")})})}),e.jsx(a,{className:"gutter-row",span:4,children:e.jsx("p",{style:{textAlign:"right"},children:e.jsx("strong",{children:s("PRICE")})})}),e.jsx(a,{className:"gutter-row",span:4,children:e.jsx("p",{style:{textAlign:"right"},children:e.jsx("strong",{children:s("QUANTITY")})})}),e.jsx(a,{className:"gutter-row",span:5,children:e.jsx("p",{style:{textAlign:"right"},children:e.jsx("strong",{children:s("TOTAL")})})}),e.jsx(f,{})]}),P.map(u=>e.jsx(G,{item:u,currentErp:t},u._id)),e.jsx("div",{style:{width:"300px",float:"right",textAlign:"right",fontWeight:"700"},children:e.jsxs(g,{gutter:[12,-5],children:[e.jsx(a,{className:"gutter-row",span:12,children:e.jsxs("p",{children:[s("Sub Total")," : "]})}),e.jsx(a,{className:"gutter-row",span:12,children:e.jsx("p",{children:i({amount:t.subTotal,currency_code:t.currency})})}),e.jsx(a,{className:"gutter-row",span:12,children:e.jsxs("p",{children:["Tax Total (",t.taxRate," %) :"]})}),e.jsx(a,{className:"gutter-row",span:12,children:e.jsx("p",{children:i({amount:t.taxTotal,currency_code:t.currency})})}),e.jsx(a,{className:"gutter-row",span:12,children:e.jsxs("p",{children:[s("Total")," :"]})}),e.jsx(a,{className:"gutter-row",span:12,children:e.jsx("p",{children:i({amount:t.total,currency_code:t.currency})})})]})})]})}function K({config:r}){const o=I(),{id:s}=k();$(),l.useLayoutEffect(()=>{o(N.read({entity:r.entity,id:s}))},[s]);const{result:n,isSuccess:y,isLoading:c=!0}=b(q);return c?e.jsx(C,{children:e.jsx(B,{})}):e.jsx(C,{children:y?e.jsx(J,{config:r,selectedItem:n}):e.jsx(W,{entity:r.entity})})}function ge(){const r=R(),o="offer",s={PANEL_TITLE:r("Offer Leads"),DATATABLE_TITLE:r("offer_list"),ADD_NEW_ENTITY:r("add_new_offer"),ENTITY_NAME:r("Offer Leads")},n={entity:o,...s};return e.jsx(K,{config:n})}export{ge as default};
